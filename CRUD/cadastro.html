<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioSys - Cadastro de Exames</title>
    <style>
        .input-group {
            margin-bottom: 15px;
        }
        #camera-container {
            width: 100%;
            max-width: 300px;
            margin-top: 10px;
            display: none;
        }
        #video {
            width: 100%;
            height: auto;
        }
        #photo {
            display: none;
            width: 100%;
            max-width: 300px;
            margin-top: 10px;
        }
    </style>
    <!-- Chamando o CSS -->
    <link rel="stylesheet" href="global.css">
</head>
<body>
    <div class="cadastro-container">
        <h2>Cadastro de Exames</h2>
        <form action="#" method="post" enctype="multipart/form-data">
            <!-- Seus campos de formulário aqui -->
            <div class="input-group">
                <label for="numero_exame"><b>Número do Exame:</b></label>
                <input type="text" id="numero_exame" name="numero_exame" required>
            </div>
            <!-- Campo de Paciente -->
            <div class="input-group">
                <label for="paciente"><b>Paciente:</b></label>
                <input type="text" id="paciente" name="paciente" required>
            </div>
            <!-- Campo de Idade -->
            <div class="input-group">
                <label for="idade"><b>Idade:</b></label>
                <input type="number" id="idade" name="idade" required>
            </div>
            <!-- Campo de Convênio -->
            <div class="input-group">
                <label for="convenio"><b>Convênio:</b></label>
                <input type="text" id="convenio" name="convenio" required>
            </div>
            <!-- Campo de Procedimento -->
            <div class="input-group">
                <label for="procedimento"><b>Procedimento:</b></label>
                <input type="text" id="procedimento" name="procedimento" required>
            </div>
            <!-- Campo de Data -->
            <div class="input-group">
                <label for="data"><b>Data:</b></label>
                <input type="date" id="data" name="data" required>
            </div>
            <!-- Campo de Hora de Início -->
            <div class="input-group">
                <label for="hora_inicio"><b>Hora de Início:</b></label>
                <input type="time" id="hora_inicio" name="hora_inicio" required>
            </div>
            <!-- Campo de Hora de Término -->
            <div class="input-group">
                <label for="hora_termino"><b>Hora de Término:</b></label>
                <input type="time" id="hora_termino" name="hora_termino" required>
            </div>
            <!-- Campo de Médico Solicitante -->
            <div class="input-group">
                <label for="medico_solicitante"><b>Médico Solicitante:</b></label>
                <input type="text" id="medico_solicitante" name="medico_solicitante" required>
            </div>
            <!-- Campo de Médico Executante -->
            <div class="input-group">
                <label for="medico_executante"><b>Médico Executante:</b></label>
                <input type="text" id="medico_executante" name="medico_executante" required>
            </div>
            <!-- Campo de Técnico Auxiliar -->
            <div class="input-group">
                <label for="tecnico_auxiliar"><b>Técnico Auxiliar:</b></label>
                <input type="text" id="tecnico_auxiliar" name="tecnico_auxiliar" required>
            </div>
            <!-- Botão e Campo de Captura de Foto -->
            <div class="input-group">
                <button type="button" id="start-camera">QR Code</button>
                <button type="button" id="take-photo" style="display:none;">Tirar Foto</button>
                <div id="camera-container">
                    <video id="video"></video>
                </div>
                <img id="photo" alt="Foto Capturada">
                <input type="hidden" id="photo-data" name="photo-data">
            </div>
            <!-- Botão de Cadastro -->
            <div class="button-container">
                <div class="button-group">
                    <button type="submit" class="cadastro-btn"><strong>Cadastrar</strong></button>
                </div>
            </div>
        </form>
    </div>
    <!-- Script para adicionar leitor de QR code -->
    <script>
        const startCameraButton = document.getElementById('start-camera');
        const takePhotoButton = document.getElementById('take-photo');
        const video = document.getElementById('video');
        const cameraContainer = document.getElementById('camera-container');
        const photo = document.getElementById('photo');
        const photoDataInput = document.getElementById('photo-data');
        
        startCameraButton.addEventListener('click', async () => {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = stream;
                cameraContainer.style.display = 'block';
                takePhotoButton.style.display = 'inline-block';
                video.play();
            } catch (error) {
                alert('Erro ao acessar a câmera: ' + error.name + ' - ' + error.message);
            }
        });

        takePhotoButton.addEventListener('click', () => {
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0);
            const dataURL = canvas.toDataURL('image/png');
            photo.src = dataURL;
            photo.style.display = 'block';
            photoDataInput.value = dataURL;
            video.pause();
            video.srcObject.getTracks().forEach(track => track.stop());
            cameraContainer.style.display = 'none';
            takePhotoButton.style.display = 'none';
        });
    </script>
</body>
</html>
